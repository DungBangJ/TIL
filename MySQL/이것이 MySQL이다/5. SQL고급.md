- [MySQL의 데이터 형식](#mysql의-데이터-형식)
  - [MySQL에서 지원하는 데이터 형식의 종류](#mysql에서-지원하는-데이터-형식의-종류)
    - [숫자 데이터 형식](#숫자-데이터-형식)
    - [문자 데이터 형식](#문자-데이터-형식)
    - [날짜와 시간 데이터 형식](#날짜와-시간-데이터-형식)
    - [기타 데이터 형식](#기타-데이터-형식)
    - [LONGTEXT, LONGBLOB](#longtext-longblob)
  - [변수의 사용](#변수의-사용)
  - [데이터 형식과 형 변환](#데이터-형식과-형-변환)
    - [데이터 형식 변환 함수](#데이터-형식-변환-함수)
    - [암시적인 형 변환](#암시적인-형-변환)
  - [MySQL 내장 함수](#mysql-내장-함수)
    - [제어 흐름 함수](#제어-흐름-함수)
      - [IF(수식, 참, 거짓)](#if수식-참-거짓)
      - [IFNULL(수식1, 수식2)](#ifnull수식1-수식2)
      - [NULLIF(수식1, 수식2)](#nullif수식1-수식2)
      - [CASE~WHEN~ELSE~END](#casewhenelseend)
    - [문자열 함수](#문자열-함수)
      - [ASCII(아스키 코드), CHAR(숫자)](#ascii아스키-코드-char숫자)
      - [BIT_LENGTH(문자열), CHAR_LENGTH(문자열), LENGTH(문자열)](#bit_length문자열-char_length문자열-length문자열)
      - [CONCAT(문자열1, 문자열2, ...), CONCAT_WS(구분자, 문자열1, 문자열2, ...)](#concat문자열1-문자열2--concat_ws구분자-문자열1-문자열2-)
      - [ELT(위치, 문자열1, 문자열2, ...), FIELD(찾을 문자열, 문자열1, 문자열2, ...), FIND_IN_SET(찾을 문자열, 문자열 리스트), INSTR(기준 문자열, 부분 문자열), LOCATE(부분  문자열, 기준 문자열)](#elt위치-문자열1-문자열2--field찾을-문자열-문자열1-문자열2--find_in_set찾을-문자열-문자열-리스트-instr기준-문자열-부분-문자열-locate부분--문자열-기준-문자열)
      - [FORMAT(숫자, 소수점 자릿수)](#format숫자-소수점-자릿수)
      - [BIN(숫자), HEX(숫자), OCT(숫자)](#bin숫자-hex숫자-oct숫자)
      - [INSERT(기준 문자열, 위치, 길이, 삽입할 문자열)](#insert기준-문자열-위치-길이-삽입할-문자열)
      - [LEFT(문자열, 길이), RIGHT(문자열, 길이)](#left문자열-길이-right문자열-길이)
      - [UPPER(문자열), LOWER(문자열)](#upper문자열-lower문자열)
      - [LPAD(문자열, 길이, 채울 문자열), RPAD(문자열, 길이, 채울 문자열)](#lpad문자열-길이-채울-문자열-rpad문자열-길이-채울-문자열)
      - [LTRIM(문자열), RTRIM(문자열)](#ltrim문자열-rtrim문자열)
      - [TRIM(문자열), TRIM(방향 자를_문자열 FROM 문자열)](#trim문자열-trim방향-자를_문자열-from-문자열)
      - [REPAEAT(문자열, 횟수)](#repaeat문자열-횟수)
      - [REPLACE(문자열, 원래 문자열, 바꿀 문자열)](#replace문자열-원래-문자열-바꿀-문자열)
      - [REVERSE(문자열)](#reverse문자열)
      - [SPACE(길이)](#space길이)
      - [SUBSTRING(문자열, 시작위치, 길이) 또는 SUBSTRING(문자열 FROM 시작위치 FOR 길이)](#substring문자열-시작위치-길이-또는-substring문자열-from-시작위치-for-길이)
      - [SUBSTRING_INDEX(문자열, 구분자, 횟수)](#substring_index문자열-구분자-횟수)



---

# MySQL의 데이터 형식

## MySQL에서 지원하는 데이터 형식의 종류

### 숫자 데이터 형식

|   데이터 형식   | 바이트 수 |      숫자 범위      |                         설명                         |
| :-------------: | :-------: | :-----------------: | :--------------------------------------------------: |
|    SMALLINT     |     2     |   -32678 ~ 32767    |                         정수                         |
|       INT       |     4     |    -21억 ~ 21억     |                         정수                         |
|     BIGINT      |     8     |   -900경 ~ 900경    |                         정수                         |
|      FLOAT      |     4     | -3.40E38 ~ 1.17E-38 |              소수점 아래 7자리까지 표현              |
| DECIMAL(m, [d]) |   5~17    |  -1E38+1 ~ 1E38-1   | 전체 자릿수(m)와 소수점 이하 자릿수(d)를 가진 숫자형 |

- DECIMAL
  - 데이터 형식은 정확한 수치를 저장
- FLOAT, DOUBLE
  - 근사치를 저장
  - 상당히 큰 숫자를 저장할 수 있다.

### 문자 데이터 형식

|       데이터 형식       |   바이트 수    |                   설명                    |
| :---------------------: | :------------: | :---------------------------------------: |
|         CHAR(n)         |    1 ~ 255     |  고정길이 문자형. n을 1부터 255까지 지정  |
|       VARCHAR(n)        |   1 ~ 65535    | 가변길이 문자형. n을 1부터 65535까지 지정 |
| LONGTEXT<br/>(TEXT형식) | 1 ~ 4294967295 |      최대 4GB 크기의 TEXT 데이터 값       |
| LONGBLOB<br/>(BLOB형식) | 1 ~ 4294967295 |      최대 4GB 크기의 BLOB 데이터 값       |

- CHAR(n)은 영문, 한글 구분없이 n글자를 입력하는 것
- BINARY, VARBINARY
  - 바이트 단위의 이진 데이터 값 저장
- TEXT, TINYTEXT, MEDIUMTEXT, LONGTEXT
  - 대용량의 글자를 저장하기 위한 형식
- BLOB, TINYBLOB, MEDIUMBLOB, LONGBLOB
  - 사진 파일, 동영상 파일, 문서 파일 등의 대용량의 이진 데이터를 저장하는 데 사용

### 날짜와 시간 데이터 형식

| 데이터 형식 | 바이트 수 | 설명                                                                                                  |
| :---------: | :-------: | :---------------------------------------------------------------------------------------------------- |
|    DATE     |     3     | 1001-01-01 ~ 9999-12-31의 범위까지만 저장<br/>'YYYY-MM-DD'형식으로 사용                               |
|  DATETIME   |     8     | 1001-01-01 00:00:00 ~ 9999-12-31 23:59:59의 범위까지만 저장<br/>'YYYY-MM-DD HH:MM:SS'의 형식으로 사용 |

### 기타 데이터 형식

| 데이터 형식 | 바이트 수 |                                    설명                                     |
| :---------: | :-------: | :-------------------------------------------------------------------------: |
|  GEOMETRY   |    N/A    | 공간 데이터 형식으로 선, 점 및 다각형 같은 공간 데이터 개체를 저장하고 조작 |
|    JSON     |     8     |                JSON(JavaScript Object Notation) 문서를 저장                 |

### LONGTEXT, LONGBLOB

MySQL은 LOB(Large Object: 대량의 데이터)저장하기 위해서 LONGTEXT, LONGBLOB 데이터 형식을 지원한다.

- 지원되는 데이터 크기는 약 4GB 크기의 파일을 하나의 데이터로 저장할 수 있다.

## 변수의 사용

SQL도 변수를 선언하고 사용할 수 있다.

```SQL
SET @변수이름 = 변수의 값; -- 변수 선언 및 값 대입
SELECT @변수이름; -- 변수의 값 출력
```

- 스토어드 프로시저나 함수 안에서의 변수 사용 방법은 DECLARE문으로 선언한 후에 사용하는 것이다.
- 변수는 Workbench를 닫았다가 재시작하면 소멸된다.

```SQL
USE sqldb;

SET @myVar1 = 5; 
SET @myVar2 = 3;
SET @myVar3 = 4.25;
SET @myVar4 = '가수이름 ==>'

SELECT @myVar1;
SELECT @myVar2 + @myVar3;
SELECT @myVar4, Name FROM usertbl WHERE height > 180;
```

LIMIT에는 원칙적으로 변수를 사용할 수 없지만, PREPARE와 EXECUTE문을 활용해서 변수를 사용할 수 있다.

```SQL
SET @myVAar1 = 3;
PREPARE myQuery
    FROM 'SELECT Name, height FROM usertbl ORDER BY height LIMIT ?';
EXECUTE myQuery USING @myVar1;
```

- 'LIMIT @변수'형시긍로 사용하면 오류 발생
- PREPARE 쿼리이름 FROM '쿼리문'
  - 쿼리이름에 '쿼리문'을 준비만 해놓고 실행하지는 않는다.
- EXECUTE 쿼리이름 USING @변수
  - EXECUTE문을 만나면 PREPARE문이 드디어 시작된다.
    - 여기서 USING 뒤에 나오는 @변수가 PREPARE문의 ?에 대입된다.

## 데이터 형식과 형 변환

### 데이터 형식 변환 함수

CAST(), CONVERT()

```SQL
CAST(expression AS 데이터형식[(길이)])
CONVERT(expression AS 데이터형식[(길이)])
```

```SQL
USE sqldb;
SELECT AVG(amount) AS '평균 구매 개수' FROM buytbl;

SELECT CAST(AVG(amount) AS SIGNED INTEGER) AS '평균 구매 개수' FROM buytbl;
-- SELECT CAST(AVG(amount), SIGNED INTEGER) AS '평균 구매 개수' FROM buytbl; //이것도 가능
```

- 쿼리의 결과를 보기 좋도록 처리할 때도 사용된다.

```SQL
SELECT 
    num, 
    CONCAT(CAST(price AS CHAR(10)), 'X', CAST(amount AS CHAR(4)), '=') AS '단가X수량',
    price*amount AS '구매액'
FROM buytbl;
```

### 암시적인 형 변환

암시적 형 변환(Implicit conversion)

- CAST()나 CONVERT() 함수를 사용하지 않고 형이 변환되는 것

```SQL
SELECT '100' + '200'; -- 문자와 문자를 더함(정수로 변환되서 연산됨)
SELECT CONCAT('100', '200'); -- 문자와 문자를 연결(문자로 처리)
SELECT CONCAT(100, '200'); -- 정수와 문자를 연결(정수가 문자로 변환되서 처리)
SELECT 1 > '2mega'; -- 정수인 2로 변환되어서 비교
SELECT 3 > '2MEGA'; -- 정수인 2로 변환되어서 비교
SELECT 0 = 'mega2'; --문자는 0으로 변환됨
```

명시적 형 변환(Explicit conversion)

- CAST()나 CONVERT() 함수를 이용해서 데이터 형식을 변환하는 것

## MySQL 내장 함수

### 제어 흐름 함수

프로그램의 흐름을 제어한다.

#### IF(수식, 참, 거짓)

```SQL
SELECT IF (100>200, '참이다.','거짓이다.'); -- 거짓 출력
```

#### IFNULL(수식1, 수식2)

- 수식1이 NULL이 아니면 수식1이 반환
- 수식1이 NULL이면 수식2가 반환

```SQL
SELECT IFNULL(NULL, '널이군요'), IFNULL(100, '널이군요'); -- '널이군요', 100 출력
```

#### NULLIF(수식1, 수식2)

- 수식1과 수식2가 같으면 NULL반환
- 다르면 수식1 반환

```SQL
SELECT NULLIF(100,100), NULLIF(200,100); -- NULL, 200 출력
```

#### CASE~WHEN~ELSE~END

- CASE는 내장 함수가 아니고 연산자
- 다중 분기에 사용

```SQL
SELECT CASE 10
        WHEN 1 THEN '일'
        WHEN 5 THEN '오'
        WHEN 10 THEN '십'
        ELSE '모름'
END AS 'CASE연습';
```

### 문자열 함수

문자열을 조작

#### ASCII(아스키 코드), CHAR(숫자)

문자의 아스키 코드값을 반환하거나 숫자의 아스키 코드값에 해당하는 문자를 반환한다.

```SQL
SELECT ASCII('A'), CHAR(65); -- 65, A 출력
```

#### BIT_LENGTH(문자열), CHAR_LENGTH(문자열), LENGTH(문자열)

BIT_LENGTH(문자열)

- 할당된 Bit 크기 또는 문자 크기를 반환한다.

CHAR_LENGTH(문자열)

- 문자의 개수를 반환

LENGTH(문자열)

- 할당된 Byte수를 반환한다.

```SQL
SELECT BIT_LENGTH('abc'), CHAR_LENGTH('abc'), LENGTH('abc');
SELECT BIT_LENGTH('가나다'), CHAR_LENGTH('가나다'), LENGTH('가나다');
```

- MySQL은 기본적으로 UTF-8코드
  - 영문은 3byte, 한글은 3x3 = 9byte를 할당

#### CONCAT(문자열1, 문자열2, ...), CONCAT_WS(구분자, 문자열1, 문자열2, ...)

문자열을 이어준다. CONCAT_WS()는 구분자와 함께 문자열을 이어준다.

```SQL
SELECT CONCAT_WS('/', '2025', '01', '01');
-- 2025/01/01 출력
```

#### ELT(위치, 문자열1, 문자열2, ...), FIELD(찾을 문자열, 문자열1, 문자열2, ...), FIND_IN_SET(찾을 문자열, 문자열 리스트), INSTR(기준 문자열, 부분 문자열), LOCATE(부분  문자열, 기준 문자열)

```SQL
SELECT 
    ELS(2, '하나', '둘', '셋'), -- 둘 출력
    FIELD('둘', '하나', '둘', '셋'), -- 2 출력
    FIND_IN_SET('둘', '하나,둘,셋'), -- 2 출력
    INSTR('하나둘셋','둘'), -- 3 출력
    LOCATE('둘', '하나둘셋'); -- 3 출력
```

#### FORMAT(숫자, 소수점 자릿수)

숫자를 소수점 아래 자릿수까지 표현

- 1000단위마다 콤마를 추가해준다.

```SQL
SELECT FORMAT(123456.123456, 4); --123,456.1235 출력
```

#### BIN(숫자), HEX(숫자), OCT(숫자)

2진수, 16진수, 8진수의 값을 반환

```SQL
SELECT BIN(31), HEX(31), OCT(31); -- 11111, 1F, 37 출력
```

#### INSERT(기준 문자열, 위치, 길이, 삽입할 문자열)

기준 문자열의 위치부터 길이만큼을 지우고 삽입할 문자열을 끼워 넣는다.

```SQL
SELECT 
    INSERT('abcdefghi', 3, 4, '@@@@'), -- ab@@@@ghi 출력
    INSERT('abcdefghi', 3, 2, '@@@@'); -- ab@@@@efghi 출력
```

#### LEFT(문자열, 길이), RIGHT(문자열, 길이)

왼쪽 또는 오른쪽에서 문자열의 길이만큼 반환한다.

```SQL
SELECT
    LEFT('abcdefghi', 3), -- abc 출력
    RIGHT('abcdefghi', 3); -- ghi 출력
```

#### UPPER(문자열), LOWER(문자열)

소문자를 대문자로, 대문자를 소문자로 변경

- LCASE(), UCASE()와 동일한 함수

```SQL
SELECT 
    LOWER('ABCDEFGHI'), -- abcdefghi 출력
    UPPER('abcdefghi'); -- ABCDEFGHI 출력
```

#### LPAD(문자열, 길이, 채울 문자열), RPAD(문자열, 길이, 채울 문자열)

문자열의 길이만큼 늘린 후에, 빈 곳을 채울 문자열로 채운다.

```SQL
SELECT 
    LPAD('이것이', 5, '##'), ##이것이 출력
    RPAD('이것이', 5, '##'); 이것이## 출력
```

#### LTRIM(문자열), RTRIM(문자열)

문자열의 왼쪽, 오른쪽 공백을 제거한다.

- 중간의 공백은 제거 불가

```SQL
SELECT 
    LTRIM('   이것이'), -- 이것이 출력
    RTRIM('이것이   '); -- 이것이 출력
```

#### TRIM(문자열), TRIM(방향 자를_문자열 FROM 문자열)

- TRIM(문자열)
  - 문자열의 앞뒤 공백을 모두 없앤다.
- TRIM(방향 자를_문자열 FROM 문자열)
  - 방향
    - LEADING(앞)
    - BOTH(양쪽)
    - TRAILING(뒤)

```SQL
SELECT
    TRIM('   이것이   '), -- 이것이 출력
    TRIM(BOTH 'ㅋ' FROM 'ㅋㅋㅋ재밌다.ㅋㅋㅋ'); -- 재밌다. 출력
```

#### REPAEAT(문자열, 횟수)

문자열을 횟수만큼 반복

```SQL
SELECT REPEAT('이것이', 3); -- 이것이이것이이것이 출력
```

#### REPLACE(문자열, 원래 문자열, 바꿀 문자열)

문자열에서 원래 문자열을 찾아서 바꿀 문자열로 바꿔준다.

```SQL
SELECT
    REPLACE('이것이 MySQL이다.', '이것이', 'This is'); -- This is MySQL이다 출력
```

#### REVERSE(문자열)

문자열의 순서를 거꾸로 만든다.

```SQL
SELECT REVERSE ('MySQL'); -- LQSyM 출력
```

#### SPACE(길이)

길이만큼의 공백을 반환한다.

```SQL
SELECT CONCAT('이것이', SPACE(10), 'MySQL이다'); -- 이것이          MySQL이다 출력
```

#### SUBSTRING(문자열, 시작위치, 길이) 또는 SUBSTRING(문자열 FROM 시작위치 FOR 길이)

시작위치부터 길이만큼 문자를 반환

- 길이가 생략되면 문자열의 끝까지 반환

```SQL
SELECT SUBSTRING('대한민국만세', 3, 2); -- 민국 출력
```

- SUBSTRING(), SUBSTR(), MID() 동일하다.

#### SUBSTRING_INDEX(문자열, 구분자, 횟수)

문자열에서 구분자가 왼쪽부터 횟수 번째 나오면 그 이후의 오른쪽은 버린다.

- 횟수가 음수면 오른쪽부터 세고 왼쪽을 버린다.

```SQL
SELECT 
  SUBSTRING_INDEX('cafe.naver.com', '.', 2), -- cafe.naver 출력
  SUBSTRING_INDEX('cafe.naver.com', '.', -2); -- naver.com 출력
```
