- [DBMS 개요](#dbms-개요)
  - [데이터베이스의 정의와 특징](#데이터베이스의-정의와-특징)
  - [DBMS 분류](#dbms-분류)
  - [SQL 개요](#sql-개요)
- [MySQL 전체 운영 실습](#mysql-전체-운영-실습)
  - [요구사항 분석과 시스템 설계 그리고 모델링](#요구사항-분석과-시스템-설계-그리고-모델링)
  - [데이터베이스 모델링과 필수 용어](#데이터베이스-모델링과-필수-용어)
  - [MySQL을 이용한 데이터베이스 구축 절차](#mysql을-이용한-데이터베이스-구축-절차)
- [테이블 외의 데이터베이스 개체의 활용](#테이블-외의-데이터베이스-개체의-활용)
  - [인덱스](#인덱스)
  - [뷰(view)](#뷰view)
  - [스토어드 프로시저](#스토어드-프로시저)
  - [트리거](#트리거)

# DBMS 개요

## 데이터베이스의 정의와 특징

데이터 베이스

- 데이터의 집합
- 여러 명의 사용자나 응요 프로그램이 공유하고 동시에 접근 가능
- 데이터의 저장공간 자체를 의미하기도 한다.
  - MySQL에서는 데이터베이스를 자료가 저장되는 디스크 공간으로 취급

DBMS

- 데이터베이스를 관리, 운영

데이터베이스 또는 DBMS의 특성

- 데이터의 무결성
- 데이터의 독립성
  - 데이터베이스의 위치나 크기가 변해도 내용은 영향을 받지 않아야 한다.
- 보안
- 데이터 중복의 최소화
- 응용 프로그램 제작 및 수정이 쉬워짐
- 데이터의 안전성 향상
  - 대부분의 DBMS가 제공하는 백업, 복원 기능을 이용

## DBMS 분류

현재는 관계형 DBMS가 가장 많은 부분을 차지한다.

- 계층형 DBMS(Hierarchical DBMS)
  - 트리 형태(1:N 구조)
  - 검색은 빠르지만, 접근의 유연성이 부족
- 망형 DBMS(Network DBMS)
  - 1:N, M:N
    - 더 빠르고 효과적인 데이터 추출 가능
  - 복잡한 내부 포인터
- 관계형 DBMS(Relational DBMS)
  - 데이터베이스는 테이블이라 불리는 최소 단위로 구성되어 있고 이 테이블은 하나 이상의 열로 구성되어 있다.
    - 테이블 = 릴레이션 = 엔티티
      - 테이블의 관계를 기본 키와 외래 키를 사용해 맺어 준다.(부모 자식 관계)
  - 비교적 업무 변화에 유연
  - 유지보수 편리
  - 시스템 자원을 많이 차지해서 시스템이 전반적으로 느려진다.
    - 많이 보완 중

## SQL 개요

SQL(Structured Query Language)

- 관계형 데이터베이스에서 사용되는 언어
- 표준 SQL은 대부분의 DBMS 제품에서 공통적으로 호환
- 이식성이 좋다.
- 표준이 계속 발전한다.
- 대화식 언어
  - 바로 질의하고 결과를 얻는 대화식 언어
- 분산형 클라이언트/서버 구조이다.
- 모든 DBMS의 SQL문이 완벽하게 동일하지는 않다.

# MySQL 전체 운영 실습

## 요구사항 분석과 시스템 설계 그리고 모델링

정보시스템 구축 5단계

- 분석
  - 무엇을 할 것인가를 결정
  - 분석의 결과로서 많은 문서를 작성해야 한다.
- 설계
  - 시스템을 어떻게 구축할 것인지를 결정
- 구현
- 시험
- 유지보수

## 데이터베이스 모델링과 필수 용어

데이터베이스 모델링

- 현실세계에서 사용되는 데이터를 MySQL에 어떻게 옮겨 놓을 것인지를 결정하는 과정
- 특성을 추출해서 그것들을 MySQL에 넣어야 한다.
  - 테이블이라는 형식에 맞춰야 한다.
- 용어
  - 데이터
    - 단편적인 정보
  - 테이블
    - 데이터를 입력하기 위한 표
  - 데이터베이스(DB)
    - 테이블이 저장되는 장소
  - DBMS(DataBase Management System)
    - 데이터베이스를 관리하는 시스템 또는 소프트웨어
  - 열(컬럼, 필드)
  - 열 이름
    - 고유해야 한다.
  - 데이터 형식
    - 테이블을 생성할 때 열 이름과 함께 지정
  - 행(로우, 레코드)
    - 실질적인 데이터
  - 기본키(Primary key) 열
    - 각 행을 구분하는 유일한 열
    - 중복 불가, 공백 불가
    - 각 테이블에는 기본 키가 하나만 지정
  - 외래 키(Foreign key) 필드
    - 두 테이블의 관계를 맺어주는 키
  - SQL(Structured Query Language)
    - 구조화된 질의 언어
    - 사람과 DBMS가 소통하기 위한 언어

## MySQL을 이용한 데이터베이스 구축 절차

1. 데이터베이스 생성
   인스턴스는 MySQL 프로그램이 컴퓨터에서 활성화되어 있는 서비스를 말한다.
   스키마(schema)는 MySQL에서는 스키마와 데이터베이스가 완전 동일한 용어로 사용된다.
2. 테이블 생성
   개체 이름(데이터베이스, 테이블 등)은 영문 사용
3. 데이터 입력
4. 데이터 활용
   데이터를 활용한다는 것은 주로 'SELECT'문을 사용한다는 의미
   SQL은 대소문자를 구분하지 않는다.
   쿼리 창에서 실행했을 때, 그 쿼리 창에 있는 모든 SQL문을 수행한다.
   - 마우스로 클릭한 줄에서 Ctrl + enter를 누르면 그 줄만 실행된다.
   테이블 이름에 띄어쓰기 허용
   - 대신 ``으로 묶어줘야 한다.
   - ```create table `my TestTBL` (id INT);```

   -- 은 공백이다.

# 테이블 외의 데이터베이스 개체의 활용

## 인덱스

- 책의 찾아보기와 같은 개념
- 테이블의 열 단위에 생성된다.
- 열을 기본 키로 설정하면 자동으로 인덱스가 생성된다.
- 데이터베이스 튜닝을 할 때 가장 집중적으로 보는 부분 중 하나
- execution plan(실행 계획)
  - 'Full Table Scan'(전체 테이블 스캔)
    - 인덱스를 사용하지 않고, 테이블 전체를 검색했다는 뜻
    - 인덱스가 없으면 이렇게 된다.
  - 'Non-Unique Key Lookup'(인덱스를 사용했다는 의미)
    - 인덱스를 사용해서 결과를 찾아냈다는 의미
    - 전체 테이블을 볼 필요 없이 인덱스만 찾았다.

## 뷰(view)

가상의 테이블

- 사용자의 입장에서는 테이블과 동일하게 보인다.
  - 실제 행 데이터를 가지고 있지 않다.
  - 진짜 테이블에 링크된 것
    - 뷰를 SELECT하면 진짜 테이블의 데이터를 조회하는 것과 동일한 결과가 나온다.
    - 뷰의 실체는 SELECT문이다.
      - 우리가 뷰에 접근하게 되면 뷰 생성 시에 입력한 SELECT문이 그때 동작한다.

```sql
create view uv_membertbl
as
 select membername, memberaddress from membertbl;
```

- 뷰인지 테이블인지 알 필요도 없이 그냥 다른 테이블과 동일하게 사용하면 된다.

```sql
select * from uv_membertbl;
```

## 스토어드 프로시저

MySQL에서 제공해주는 프로그래밍 기능

- SQL문을 하나로 묶어서 편리하게 사용하는 기능
- 매번 각 줄의 SQL문을 입력하고 실행하는 상황에서는 상당히 불편하다.
- DELIMITER는 '구분 문자'를 의미
  - 뒤에 //가 나오면 기존의 세미콜론(;)을 //로 대신한다는 의미이다.
  - 다시 제일 마지막 행에서 세미콜론(;)으로 돌려놓아야 한다.

```sql
delimiter //
create procedure myProc()
begin
 select * from membertbl where memberName = '당탕이';
    select * from producttbl where productName = '냉장고';
end //
delimiter ;
```

- 이 스토어드 프로시저를 부르기 위해서는 다음의 명령어를 사용하면 된다.

```sql
CALL 스토어드프로시저_이름();
CALL myProc();
```

- procedure 생성
  - ```create procedure 스토어드프로시저_이름```
- procedure 삭제
  - ```drop procedure 스토어드프로시저_이름```

## 트리거

테이블에 부착되어서 테이블에 INSERT나 UPDATE 또는 DELETE 작업이 발생되면 자동으로 실행되는 코드를 말한다.

- 사용자는 더 이상 행 데이터를 삭제하기 전에 다른 곳에 저장해야 하는 업무적 부담에서 벗어나게 될 뿐 아니라 삭제된 모든 사용자는 완벽하게 별도의 곳에 저장된다.
- 지원진 데이터를 보관할 테이블을 따로 만들어서 관리해야 한다.

```sql
create table deletedMembertbl(
 memberID char(8),
    memberName char(5),
    memberAddress char(20),
    deletedDate DATE -- 삭제한 날짜
);
```

- DELETE 작업이 일어나면 백업 테이블(deleteMembertbl)에 지워진 데이터가 기록되는 트리거를 생성해야 한다.

```sql
delimiter //
create trigger trg_deletedMemberTBL -- 트리거 이릅
 after delete -- 삭제 후에 작동하게 지정
    on memberTBL -- 트리거를 부착할 테이블
    for each row -- 각 행마다 적용시킴
begin
 -- old 테이블의 내용을 백업 테이블에 삽입
    insert into deletedMemberTBL
   values (old.memberID, old.memberName, old.memberAddress, curdate());
end //
delimiter ;
```

